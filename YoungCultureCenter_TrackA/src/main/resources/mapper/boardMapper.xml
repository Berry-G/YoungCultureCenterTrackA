<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.youngtvjobs.ycc.board.boardMapper" >


	<sql id="selectFromBoard">
		SELECT article_id, article_date, article_board_type, user_id, 
		article_title, article_contents, article_viewcnt
		FROM article
	</sql>
	
	<sql id="searchCondition">
		<choose>
			<when test='option=="T"'>
				AND article_title LIKE concat('%', #{keyword}, '%')
			</when>
			<when test='option=="W"'>
				AND user_id LIKE concat('%', #{keyword}, '%')
			</when>	
			<otherwise>
				AND (article_title LIKE concat('%', #{keyword}, '%')
				OR article_contents LIKE concat('%', #{keyword}, '%'))
			</otherwise>	
		</choose>	
	</sql>
	

	
	<select id="selectPage" parameterType="map" resultType="BoardDto">
		<include refid="selectFromBoard" />
		order by article_date desc, article_id desc 
		limit #{pageSize} offset #{offset}		
	</select>

	<select id="searchResultCnt" parameterType="SearchItem" resultType="int">
		select count(*) 
		from article
		where article_Board_type  = 'N'
		and  true 
		<include refid="searchCondition" />
	</select>
	
	<select id="searchSelectPage" parameterType="SearchItem" resultType="BoardDto">
		select article_id,  article_date,   article_Board_type ,  user_id , 
		article_title, article_contents, article_viewcnt  
		from  article
		where article_Board_type = 'N'
		and  true 
		<include refid="searchCondition" />		
		order by article_date desc, article_id desc 
		limit #{pageSize} offset #{offset}		
	</select>
</mapper>